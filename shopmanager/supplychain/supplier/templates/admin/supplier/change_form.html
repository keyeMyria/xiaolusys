{% extends "admin/change_form.html" %}
{% load i18n %}

{% block extrahead %}{{ block.super }}

<script src="{{ STATIC_URL }}jquery/jquery.js"></script>
<script>
    $(document).ready(function() {
    	
    	$('form').submit(function(e){
    		
    		if ( window.location.href.indexOf('_popup') < 0){
    			return true;
    		}
    		e.preventDefault();
    		var form = $(this);
    		
    		var callback = function(resp){
    			window.opener.location.reload(true);
    			window.close();
    		}
    		
    		var form_array = form.serializeArray();
	        var params = {};
			
		    $.each(form_array,function(i, n){
		        params[n['name']] = n['value'];
		    });
    		console.log('array:',params);
    		$.post(form.attr('action'),params,callback);
    		return false;
    	});
    });
</script>
{% endblock extrahead %}


