<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>产品退款状况列表</title>
    <link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script type="text/javascript" src="//cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
    <script type="text/javascript" src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="//cdn.bootcss.com/jqcloud/1.0.4/jqcloud-1.0.4.js"></script>
    <link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/jqcloud/1.0.4/jqcloud.css">
    <script type="text/javascript" src="{{ STATIC_URL }}layer-v1.9.2/layer/layer.js"></script>
    <script type="text/javascript" src="http://cdn.hcharts.cn/highcharts/highcharts.js"></script>
    <script type="text/javascript" src="//cdn.bootcss.com/highcharts/4.1.9/modules/exporting.js"></script>
</head>
<body class="container">
<h3 style="margin-top: 40px;height: 30px">产品退款状况列表
    <small>当前买手：{{ username }}</small>
</h3>

<table class="table table-striped" style="text-align: center; margin-top: 50px">
    <thead style="text-align: center">
    <tr>
        <th>产品图片</th>
        <th>24小时内</th>
        <th>24小时外</th>
        <th>发货后</th>
        <th>同款销量</th>
    </tr>
    </thead>
    <tbody id="table_tbody">
    </tbody>

</table>
<div style="text-align: center"><a onclick="addPageNumber()">更多</a></div>
</body>


<script>
    var pageNumber = 1;
    function addPageNumber() {//加载数据
        console.log();
        var url = "/rest/v1/prorefrcd?page=" + pageNumber;
        $.ajax({
            "url": url,
            "data": {},
            "type": "get",
            dataType: 'json',
            success: searTradeCallback,
            error: function (err) {
                var resp = JSON.parse(err.responseText);
                if (resp.detail) {
                    layer.msg(resp.detail);
                }
            }
        });
        function searTradeCallback(res) {
            console.log(res);
            pageNumber += 1;
            $.each(res.results, function (i, obj) {
                var container_str = '<tr>' +
                        '<td style="width: 80px;">' +
                        '<img src="{1}"style="width:70px;" class="img-circle" onclick="popRcdpage({0})">' +
                        '</td>' +
                        '<td style="width: 200px;">{2}</td>' +
                        '<td style="width: 300px;">{3}</td>' +
                        '<td style="width: 300px;">{4}</td>' +
                        '<td style="width: 300px;">{5}</td>' +
                        '</tr>';

                var container = String.format(container_str,
                        obj.product,
                        obj.pro_pic,
                        obj.ref_num_in,
                        obj.ref_num_out,
                        obj.ref_sed_num,
                        obj.same_mod_sale_num
                );
                $("#table_tbody").append(container);
                // 柱状图　退款分布
            })
        }
    }

    $(document).ready(function () {
        addPageNumber(pageNumber);
    });

    function popRcdpage(id) {
        console.log(id);
        layer.open({
            type: 2,
            title: '产品退款分析页',
            shadeClose: true,
            shade: 0.8,
            area: ['1200px', '70%'],
            content: '/mm/ref_reason/?pro_id='+id
        });

    }

    <!--字符串format函数-->
    String.format = function () {
        if (arguments.length == 0)
            return null;
        var str = arguments[0];
        for (var i = 1; i < arguments.length; i++) {
            var re = new RegExp('\\{' + (i - 1) + '\\}', 'gm');
            str = str.replace(re, arguments[i]);
        }
        return str;
    };
</script>
</html>